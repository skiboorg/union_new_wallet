"use strict";(globalThis["webpackChunkrupay_wallet"]=globalThis["webpackChunkrupay_wallet"]||[]).push([[585],{94585:(e,t,i)=>{i.r(t),i.d(t,{default:()=>j});i(40702);var s=i(59835),h=i(86970);const n=(0,s._)("div",{class:"",style:{height:"60px"}},null,-1),o={key:0,class:"relative-position"},a={key:0,class:"flex column items-center justify-center q-mt-sm"},p={key:0,class:"text-bold text-h5 text-uppercase q-px-lg",id:"timer"},l={key:1,class:"q-mt-sm"},r={key:2,style:{height:"90vh"},class:"flex column items-center justify-evenly"},c={class:"text-negative text-bold"},d={style:{"margin-left":"-6px"},class:"text-bold text-h4 text-uppercase q-mb-md"},y={key:0,class:"flex items-center justify-center full-width"},m=["onClick"],u=["src"],g={key:3,style:{height:"90vh"},class:"flex column items-center justify-center"},f={class:"text-bold text-h5 text-uppercase q-mb-md"},v={class:"flex items-center justify-center full-width"},w={class:"flex column items-center justify-evenly full-height"},x={class:"no-margin text-uppercase text-white text-caption"},k={class:"text-weight-medium"},M={class:"no-margin text-uppercase text-white text-caption"},b={class:"text-weight-medium"},z={class:"no-margin text-uppercase text-white text-caption"},_={class:"text-weight-medium"},P={class:"no-margin text-uppercase text-white text-caption"},I={class:"text-weight-medium"},G={class:"no-margin text-uppercase text-white text-caption"},T={class:"text-weight-medium"},A=(0,s._)("div",{style:{position:"absolute"},id:"puzzle_wrapper",class:"full-width"},[(0,s._)("div",{id:"forPuzzle",class:""})],-1);function q(e,t,i,q,B,R){const C=(0,s.up)("page-header"),E=(0,s.up)("q-inner-loading"),O=(0,s.up)("q-card-section"),D=(0,s.up)("q-card"),F=(0,s.up)("page-body"),L=(0,s.up)("page");return(0,s.wg)(),(0,s.j4)(L,{style:{overflow:"hidden",position:"fixed"}},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C),n,"puzzle"===B.game_type?((0,s.wg)(),(0,s.iD)("div",o,[(0,s.Wm)(E,{showing:B.is_loading},null,8,["showing"]),B.gameType?((0,s.wg)(),(0,s.iD)("div",a,[B.gameReady&&B.gameType?((0,s.wg)(),(0,s.iD)("div",p,"00:00")):(0,s.kq)("",!0),B.gameReady&&B.gameType?((0,s.wg)(),(0,s.iD)("p",{key:1,class:"no-margin text-bold text-caption text-uppercase cursor-pointer",onClick:t[0]||(t[0]=(...e)=>R.resetGame&&R.resetGame(...e))},(0,h.zw)(e.$t("reset_game")),1)):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("div",l)),B.gameType||B.gameReady?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("p",null,(0,h.zw)(e.$t("your_balance"))+": "+(0,h.zw)(B.puzzle_user.balance),1),(0,s._)("p",c,(0,h.zw)(e.$t("game_in_testing")),1),(0,s._)("p",d,(0,h.zw)(e.$t("choose_game")),1),R.can_play?((0,s.wg)(),(0,s.iD)("div",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.gameTypes,(e=>((0,s.wg)(),(0,s.iD)("div",{onClick:t=>R.selectGame(e),class:"game-type flex column items-center justify-between q-mr-md cursor-pointer",key:e.id},[(0,s._)("img",{src:e.img,alt:""},null,8,u)],8,m)))),128))])):(0,s.kq)("",!0)])),B.gameType&&!B.gameReady?((0,s.wg)(),(0,s.iD)("div",g,[(0,s._)("p",f,(0,h.zw)(e.$t("choose_difficult")),1),(0,s._)("div",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(B.levels,((t,i)=>((0,s.wg)(),(0,s.j4)(D,{flat:"",onClick:e=>R.startGame(i),class:"q-mr-sm cursor-pointer game-level q-pa-md q-mb-sm",key:t.id},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{class:"no-padding full-height"},{default:(0,s.w5)((()=>[(0,s._)("div",w,[(0,s._)("p",x,[(0,s._)("span",k,(0,h.zw)(e.$t("level"))+":",1),(0,s.Uk)(" "+(0,h.zw)(t.name),1)]),(0,s._)("p",M,[(0,s._)("span",b,(0,h.zw)(e.$t("pieces"))+":",1),(0,s.Uk)(" "+(0,h.zw)(t.pieces),1)]),(0,s._)("p",z,[(0,s._)("span",_,(0,h.zw)(e.$t("game_price"))+":",1),(0,s.Uk)(" "+(0,h.zw)(parseFloat(t.play_cost).toFixed(2))+" OLF",1)]),(0,s._)("p",P,[(0,s._)("span",I,(0,h.zw)(e.$t("win_amount"))+":",1),(0,s.Uk)(" "+(0,h.zw)(t.balance)+" OLF",1)]),(0,s._)("p",G,[(0,s._)("span",T,(0,h.zw)(e.$t("timer"))+":",1),(0,s.Uk)(" "+(0,h.zw)(t.timer)+" "+(0,h.zw)(e.$t("minutes")),1)])])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])])):(0,s.kq)("",!0),A])):(0,s.kq)("",!0)])),_:1})])),_:1})}var B=i(43463),R=i(39981),C=i.n(R),E=i(46190),O=i(17779);const D=(0,E.c)(),F=(0,B.s)(),L={Easy:{x:3,y:3},Normal:{x:4,y:4},Difficult:{x:5,y:5}},N={data(){return{puzzle_user:{},url:"https://rupay.pro",src:null,show:!0,gameImg:null,videoTitle:"Cat",difficulty:"Normal",distance:null,isGoal:!1,sliderStart:!1,autoResize:!0,width:300,height:300,showNumber:!0,animation:!0,gameType:null,gameReady:!1,gameId:null,game_type:"puzzle",gameWin:!1,is_game_stop:!1,showAd:!1,showClose:!1,levels:[],counter:0,counterSlideTime:600,counterSlide:10,showCloseInterval:null,sliderTimerRef:null,currentAd:{image:"",video:""},is_loading:!1,AdVideo:[],gameTypes:[{id:1,name:"qr puzzle",type:"puzzle_qr",img:"game1.png",is_active:!0,is_slider:!1},{id:2,name:"art puzzle",type:"puzzle_image",img:"game2.png",is_active:!0,is_slider:!1}]}},async mounted(){await F.fetchLevels(),await F.fetchPuzzleUser(D.addresses[D.currentAddressIdx].address),this.puzzle_user=F.puzzle_user,this.levels=F.levels},computed:{can_play(){return!0},dimensions(){return L[this.difficulty]}},filters:{correct_seconds(e){return e<10?`0${e}`:e}},methods:{async onPuzzleBoardInit(){this.counterSlide=this.counterSlideTime,this.$q.loading.show(),O.log("init");const e=await this.$api.post("/api/start_game",{level_id:1,type:"puzzle_image"});O.log(e.data),this.gameId=e.data.id,this.src="https://xn--k1affs.xn--p1ai"+e.data.img,this.isGoal=!1,this.sliderStart=!0,this.$q.loading.hide()},onPuzzleBoardStart(){O.log("start");let e=this;this.sliderTimerRef=setInterval((async function(){e.counterSlide-=1,0===e.counterSlide&&(O.log("time out"),clearInterval(e.sliderTimerRef),e.gameWin=!1,e.showAd=!0);let t=parseInt(e.counterSlide/60),i=parseInt(e.counterSlide%60);t<10&&(t="0"+t),i<10&&(i="0"+i),document.getElementById("timer_slider").innerText=t+":"+i}),1e3)},async onPuzzleBoardFinish(){O.log("finish"),clearInterval(this.sliderTimerRef),this.gameWin=!0,this.showAd=!0;const e=await this.$api.post("/api/slider_win",{game_id:this.gameId});O.log(e.data)},onPuzzleBoardChange:function(e){O.log("change"),this.distance=e.distance},selectGame(e){e.is_slider?(O.log("slider"),this.game_type="slider"):(this.game_type="puzzle",this.gameType=e.type)},async resetGame(){"slider"===this.game_type?(this.game_type="puzzle",clearInterval(this.sliderTimerRef)):(document.getElementById("forPuzzle").innerHTML="",this.is_game_stop=!0,this.gameType=null,this.gameReady=!1,this.gameId=null,this.gameWin=!1),await F.fetchPuzzleUser(D.addresses[D.currentAddressIdx].address),this.puzzle_user=F.puzzle_user},async startGame(e){this.is_loading=!this.is_loading,this.is_game_stop=!1,this.gameReady=!0;const t=await C().post(this.url+"/api/puzzle/start_game",{level_id:this.levels[e].id,type:this.gameType,address:D.addresses[D.currentAddressIdx].address});O.log(t.data),this.gameId=t.data.id,this.gameReady=!0,this.createPuzzle(this.url+t.data.img,this.levels[e].pieces,this.levels[e].timer),this.is_loading=!this.is_loading},async gameOver(){await C().post(this.url+"/api/puzzle/end_game",{game_id:this.gameId,request_type:"remove_rating",game_status:this.gameWin}),await F.fetchPuzzleUser(D.addresses[D.currentAddressIdx].address),this.puzzle_user=F.puzzle_user,this.is_game_stop=!1},async winGame(){this.gameWin=!0,clearInterval(this.showCloseInterval),await this.gameOver(),this.resetGame()},async looseGame(){this.gameWin=!1,clearInterval(this.showCloseInterval),await this.gameOver(),this.resetGame()},createPuzzle(e,t,i){let s,h,n,o=60*i,a="",p=this.$q.screen.gt.md?.7:.9,l=this,r=.001;function c(e){let t,i;for(let s=e.length-1;s>=1;--s)t=Math.floor((s+1)*Math.random()),i=e[s],e[s]=e[t],e[t]=i;return e}function d(){if(o--,o<0)o=0;else{var e=parseInt(o/60),t=parseInt(o%60);e<10&&(e="0"+e),t<10&&(t="0"+t),document.getElementById("timer").innerText=e+":"+t,a=setTimeout(d,1e3)}}function y(e,t){this.x=Number(e),this.y=Number(t)}function m(e,t){this.p1=new y(e.x,e.y),this.p2=new y(t.x,t.y)}function u(){this.type="",this.points=[]}function g(e,t){this.ts=new u,this.rs=new u,this.bs=new u,this.ls=new u,this.kx=e,this.ky=t}function f(e,t){this.pckxmin=this.pckxmax=this.pckymin=this.pckymax=e,this.pieces=[e],this.puzzle=t}function v(e){"string"==typeof e.img?(this.image=new Image,this.image.src=e.img,this.image.addEventListener("load",function(t){return function(){t.createPuzzle(e)}}(this))):(this.image=e.img,this.createPuzzle(e))}function w(e){function t(t,i,s){let h;switch(s){case 0:i--;break;case 1:t++;break;case 2:i++;break;case 3:t--;break}for(h=0;h<e.length;h++)if(t==e[h].kx&&i==e[h].ky)return!0;return!1}function i(e,t,i){let s;for(s=0;s<c.length;s++)if(e==c[s].kx&&t==c[s].ky&&i==c[s].edge)return s;return!1}let s,h,n,o,a,p,l,r=[],c=[],d=[[{dkx:0,dky:0,edge:1},{dkx:1,dky:0,edge:0},{dkx:1,dky:-1,edge:3}],[{dkx:0,dky:0,edge:2},{dkx:0,dky:1,edge:1},{dkx:1,dky:1,edge:0}],[{dkx:0,dky:0,edge:3},{dkx:-1,dky:0,edge:2},{dkx:-1,dky:1,edge:1}],[{dkx:0,dky:0,edge:0},{dkx:0,dky:-1,edge:3},{dkx:-1,dky:-1,edge:2}]];for(s=0;s<e.length;s++)for(h=0;h<4;h++)t(e[s].kx,e[s].ky,h)||c.push({kx:e[s].kx,ky:e[s].ky,edge:h,kp:s});while(c.length>0){n=[],o=c[0],n.push(o),c.splice(0,1);do{for(a=0;a<3;a++)if(l=d[o.edge][a],p=i(o.kx+l.dkx,o.ky+l.dky,l.edge),!1!==p){o=c[p],n.push(o),c.splice(p,1);break}if(!1===p)break}while(1);r.push(n)}return r}/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&(r=.001),y.prototype.copy=function(){return new y(this.x,this.y)},m.prototype.length=function(){var e=this.p1.x-this.p2.x,t=this.p1.y-this.p2.y;return Math.sqrt(e*e+t*t)},m.prototype.intersect=function(e){var t=this.p1.x,i=this.p1.y,s=this.p2.x,h=this.p2.y,n=e.p1.x,o=e.p1.y,a=e.p2.x,p=e.p2.y,l=(h-i)*(a-n)-(s-t)*(p-o),r=t*(h-i)*(a-n)-n*(s-t)*(p-o)+(o-i)*(s-t)*(a-n);r/=l;var c=i*(s-t)*(p-o)-o*(h-i)*(a-n)+(n-t)*(h-i)*(p-o);return c=-c/l,new y(r,c)},m.prototype.dx=function(){return this.p2.x-this.p1.x},m.prototype.dy=function(){return this.p2.y-this.p1.y},m.prototype.cross=function(e){return this.dx()*e.dy()-this.dy()*e.dx()},m.prototype.sin=function(e){return this.cross(e)/this.length()/e.length()},m.prototype.dot=function(e){return this.dx()*e.dx()+this.dy()*e.dy()},m.prototype.cos=function(e){return this.dot(e)/this.length()/e.length()},m.prototype.pointOnAbsolute=function(e){var t=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y,s=Math.sqrt(t*t+i*i);return new y(this.p1.x+e*t/s,this.p1.y+e*i/s)},m.prototype.pointOnRelative=function(e){var t=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y;return new y(this.p1.x+e*t,this.p1.y+e*i)},m.prototype.perpendicularOrigin=function(e){var t=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y;return new m(this.p1,e?new y(this.p1.x-i,this.p1.y+t):new y(this.p1.x+i,this.p1.y-t))},m.prototype.perpendicularEnd=function(e){var t=this.p2.x-this.p1.x,i=this.p2.y-this.p1.y;return new m(this.p2,e?new y(this.p2.x-i,this.p2.y+t):new y(this.p2.x+i,this.p2.y-t))},u.prototype.drawPath=function(e,t,i,s,h){let n,o,a;if(s)if(h||e.moveTo(this.points[this.points.length-1].x-t,this.points[this.points.length-1].y-i),"d"==this.type)e.lineTo(this.points[0].x-t,this.points[0].y-i);else for(n=this.points.length-2;n>0;n--)n>1?(o=(this.points[n].x+this.points[n-1].x)/2-t,a=(this.points[n].y+this.points[n-1].y)/2-i,e.quadraticCurveTo(this.points[n].x-t,this.points[n].y-i,o,a)):e.quadraticCurveTo(this.points[n].x-t,this.points[n].y-i,this.points[n-1].x-t,this.points[n-1].y-i);else if(h||e.moveTo(this.points[0].x-t,this.points[0].y-i),"d"==this.type)e.lineTo(this.points[1].x-t,this.points[1].y-i);else for(n=1;n<this.points.length-1;n++)n<this.points.length-2?(o=(this.points[n].x+this.points[n+1].x)/2-t,a=(this.points[n].y+this.points[n+1].y)/2-i,e.quadraticCurveTo(this.points[n].x-t,this.points[n].y-i,o,a)):e.quadraticCurveTo(this.points[n].x-t,this.points[n].y-i,this.points[n+1].x-t,this.points[n+1].y-i)},g.prototype.drawPath=function(e,t,i,s){!0!==s&&e.beginPath(),this.ts.drawPath(e,t,i,!1,!1),this.rs.drawPath(e,t,i,!1,!0),this.bs.drawPath(e,t,i,!0,!0),this.ls.drawPath(e,t,i,!0,!0)},g.prototype.createDivPiece=function(e,t,i,s){let h,n,o;this.theDiv=document.createElement("div"),this.theDiv.style.width=3*e.dx+"px",this.theDiv.style.height=3*e.dy+"px",this.theDiv.style.position="absolute",this.theCanv=document.createElement("canvas"),this.theCanv.width=3*e.dx,this.theCanv.height=3*e.dy,n=e.dx*(this.kx-1),o=e.dy*(this.ky-1),h=this.ctx=this.theCanv.getContext("2d"),this.drawPath(h,n,o),h.clip(),h.drawImage(e.image,(this.kx-1)*e.dx/t+i,(this.ky-1)*e.dy/t+s,3*e.dx/t,3*e.dy/t,0,0,3*e.dx,3*e.dy);let a=1,p=2;return e.dx>100&&e.dy>100?(a=2,p=5):e.dx>50&&e.dy>50&&(a=1.5,p=3),this.drawPath(h,n+a,o+a),h.lineWidth=p,h.strokeStyle="rgba(0, 0, 0, 0.3)",h.stroke(),this.drawPath(h,n-a,o-a),h.lineWidth=p,h.strokeStyle="rgba(255, 255, 255, 0.3)",h.stroke(),this.drawPath(h,n,o),this.moveTo(new y((this.kx-1)*e.dx+v.MARGIN1,(this.ky-1)*e.dy+v.MARGIN1)),this.theDiv.appendChild(this.theCanv),this.theDiv},g.prototype.where=function(){let e,t;return e=parseFloat(this.theDiv.style.left),t=parseFloat(this.theDiv.style.top),new y(e,t)},g.prototype.moveTo=function(e){this.theDiv.style.top=e.y+"px",this.theDiv.style.left=e.x+"px"},g.prototype.insidePiece=function(e,t){let i=getComputedStyle(this.theDiv),s=e-parseFloat(i.left),h=t-parseFloat(i.top);return this.ctx.isPointInPath(s,h)},f.prototype.merge=function(e){for(let t=0;t<e.pieces.length;++t)this.pieces.push(e.pieces[t]),e.pieces[t].kx<this.pckxmin.kx&&(this.pckxmin=e.pieces[t]),e.pieces[t].kx>this.pckxmax.kx&&(this.pckxmax=e.pieces[t]),e.pieces[t].ky<this.pckymin.ky&&(this.pckymin=e.pieces[t]),e.pieces[t].ky>this.pckymax.ky&&(this.pckymax=e.pieces[t]);this.moveTo(this.where()),this.pieces.sort((function(e,t){return e.ky<t.ky?-1:e.ky>t.ky?1:e.kx<t.kx?-1:e.kx>t.kx?1:0}))},f.prototype.where=function(){return this.pieces[0].where()},f.prototype.moveTo=function(e){this.pieces[0].moveTo(e);for(let t=1;t<this.pieces.length;++t)this.pieces[t].moveTo(new y(e.x+this.puzzle.dx*(this.pieces[t].kx-this.pieces[0].kx),e.y+this.puzzle.dy*(this.pieces[t].ky-this.pieces[0].ky)))},f.prototype.ifNear=function(e){let t,i;for(let s=0;s<this.pieces.length;++s){t=this.pieces[s];for(let s=0;s<e.pieces.length;++s){if(i=e.pieces[s],t.kx==i.kx&&t.ky==i.ky+1&&this.puzzle.near(t,i,0,-1))return!0;if(t.kx==i.kx&&t.ky==i.ky-1&&this.puzzle.near(t,i,0,1))return!0;if(t.kx-1==i.kx&&t.ky==i.ky&&this.puzzle.near(t,i,-1,0))return!0;if(t.kx+1==i.kx&&t.ky==i.ky&&this.puzzle.near(t,i,1,0))return!0}}return!1},v.MARGIN1=5,v.prototype.createPuzzle=function(e){let i=this.image.width,s=this.image.height;this.reqHeight=e.height*(p+r),this.reqWidth=e.width*p,this.height=this.reqHeight-2*v.MARGIN1,this.width=this.reqWidth-2*v.MARGIN1,i/s*p>this.width/this.height?this.height=this.width*s/i:this.width=this.height*i/s,"string"==typeof e.idiv?this.divGame=document.getElementById(e.idiv):this.divGame=e.idiv,this.divGame.style.overflow="visible",this.divGame.style.position="relative",this.divBoard||(this.divBoard=document.createElement("div"),this.divGame.appendChild(this.divBoard)),this.divBoard.style.overflow="hidden",this.divBoard.style.position="absolute",this.divBoard.style.left=0,this.divBoard.style.top=0,this.listeners=[],this.divGame.style.width=this.divBoard.style.width=this.width+2*v.MARGIN1+"px",this.divGame.style.height=this.divBoard.style.height=this.height+2*v.MARGIN1+"px",this.canvMobile||(this.canvMobile=document.createElement("canvas"),this.divBoard.appendChild(this.canvMobile)),this.canvMobile.style.visibility="visible",this.canvMobile.width=parseFloat(this.divBoard.style.width),this.canvMobile.height=parseFloat(this.divBoard.style.height),this.canvMobile.style.position="absolute",this.canvMobile.style.top="0px",this.canvMobile.style.left="0px",this.canvMobile.style.zIndex=5e4,this.dCoupling=10,this.canvMobile.getContext("2d").drawImage(this.image,0,0,i,s,v.MARGIN1,v.MARGIN1,this.width,this.height),this.npieces=t,this.next()},v.prototype.returnFunct=function(e){let t=this;return function(){t.npieces=e,t.next()}},v.prototype.loadImage=function(){let e=this;return function(){uploadFile((()=>{}),{accept:"image/*",readMethod:"readAsDataURL",image:e.image})}},v.prototype.next=function(){let e,t,i,s,h,n,o,a,l,c,d,u,f,w,x,k,M,b,z,_,P,I,G=.15,T=.8,A=.9,q=.1,B=.15,R=.05,C=.1,E=.15,O=.2;this.canvMobile.style.visibility="hidden",this.computenxAndny(),e=this.nx,t=this.ny,this.image.width/this.image.height<(this.reqWidth-2*v.MARGIN1)/(this.reqHeight-2*v.MARGIN1)?(this.width=(this.reqWidth-2*v.MARGIN1)/(e+2)*e,this.height=this.width/this.image.width*this.image.height,this.height>this.reqHeight-2*v.MARGIN1&&(this.height=this.reqHeight-2*v.MARGIN1,this.width=this.height*this.image.width/this.image.height),this.freeSpace=0):(this.height=(this.reqHeight-2*v.MARGIN1)/(t+2)*t,this.width=this.height/this.image.height*this.image.width,this.width>this.reqWidth-2*v.MARGIN1&&(this.width=this.reqWidth-2*v.MARGIN1,this.height=this.width*this.image.height/this.image.width),this.freeSpace=1);let D=this.height,F=this.width;this.dx=i=this.width/e,this.dy=s=this.height/t,this.dCoupling=Math.max(10,Math.min(i,s)/10);while(this.divBoard.firstChild)this.divBoard.removeChild(this.divBoard.firstChild);this.divBoard.appendChild(this.canvMobile),this.canvMobile.width=1*this.reqWidth/p-4*v.MARGIN1,this.divGame.style.width=this.divBoard.style.width=this.canvMobile.width+"px",this.canvMobile.height=1*this.reqHeight/(p+r)-4*v.MARGIN1,this.divGame.style.height=this.divBoard.style.height=this.canvMobile.height+"px";let L=[],N=[];for(n=0;n<=t;++n)a=0==n?0:n==t?D:(n+(2*Math.random()-1)*G)*s,L[n]=new y(0,a),a=0==n?0:n==t?D:(n+(2*Math.random()-1)*G)*s,N[n]=new y(this.width,a);let W=[],S=[];for(h=0;h<=e;++h)o=0==h?0:h==e?F:(h+(2*Math.random()-1)*G)*i,W[h]=new y(o,0),o=0==h?0:h==e?F:(h+(2*Math.random()-1)*G)*i,S[h]=new y(o,this.height);let $=[];for(n=0;n<t-1;++n)for($[n]=[],h=0;h<e;++h)o=(h+.5+(2*Math.random()-1)*G/2)*i,a=(n+1+(2*Math.random()-1)*G)*s,$[n][h]=new y(o,a);let H=[];for(h=0;h<e-1;++h)for(H[h]=[],n=0;n<t;++n)a=(n+.5+(2*Math.random()-1)*G/2)*s,o=(h+1+(2*Math.random()-1)*G)*i,H[h][n]=new y(o,a);let Y=[];for(n=0;n<t-1;++n)for(Y[n]=[],h=0;h<e-1;++h)Y[n][h]=new m(H[h][n],H[h][n+1]).intersect(new m($[n][h],$[n][h+1]));for(this.pieces=[],n=0;n<t;++n)for(this.pieces[n]=[],h=0;h<e;++h)this.pieces[n][h]=new g(h,n),0==n?(this.pieces[n][h].ts.type="d",this.pieces[n][h].ts.points=[W[h].copy(),W[h+1].copy()]):(this.pieces[n][h].ts.type="z",l=0==h?L[n]:Y[n-1][h-1],c=$[n-1][h],d=h==e-1?N[n]:Y[n-1][h],this.pieces[n][h].ts.points=[l.copy(),c.copy(),d.copy()]),h==e-1?(this.pieces[n][h].rs.type="d",this.pieces[n][h].rs.points=[N[n].copy(),N[n+1].copy()]):(this.pieces[n][h].rs.type="z",l=0==n?W[h+1]:Y[n-1][h],c=H[h][n],d=n==t-1?S[h+1]:Y[n][h],this.pieces[n][h].rs.points=[l.copy(),c.copy(),d.copy()]),n==t-1?(this.pieces[n][h].bs.type="d",this.pieces[n][h].bs.points=[S[h].copy(),S[h+1].copy()]):(this.pieces[n][h].bs.type="z",l=0==h?L[n+1]:Y[n][h-1],c=$[n][h],d=h==e-1?N[n+1]:Y[n][h],this.pieces[n][h].bs.points=[l.copy(),c.copy(),d.copy()]),0==h?(this.pieces[n][h].ls.type="d",this.pieces[n][h].ls.points=[L[n].copy(),L[n+1].copy()]):(this.pieces[n][h].ls.type="z",l=0==n?W[h]:Y[n-1][h-1],c=H[h-1][n],d=n==t-1?S[h]:Y[n][h-1],this.pieces[n][h].ls.points=[l.copy(),c.copy(),d.copy()]);for(n=0;n<t;n++)for(h=0;h<e;h++)n<t-1&&(u=this.pieces[n][h].bs,f=new m(u.points[0],u.points[1]),w=new m(u.points[2],u.points[1]),I=f.sin(w)>0,f=new m(f.p1,f.pointOnRelative(Math.random()*(A-T)+T)),x=f.perpendicularEnd(!I),x=new m(x.p1,x.pointOnAbsolute(s*(Math.random()*(B-q)+q))),w=new m(w.p1,w.pointOnRelative(Math.random()*(A-T)+T)),k=w.perpendicularEnd(I),k=new m(k.p1,k.pointOnAbsolute(s*(Math.random()*(B-q)+q))),M=new m(x.p2,k.p2),b=new m(M.p1,M.pointOnAbsolute(-i*(Math.random()*(C-R)+R))),M=new m(M.p2,M.p1),z=new m(M.p1,M.pointOnAbsolute(-i*(Math.random()*(C-R)+R))),_=b.perpendicularEnd(I),_=new m(_.p1,_.pointOnAbsolute(s*(Math.random()*(O-E)+E))),P=z.perpendicularEnd(!I),P=new m(P.p1,P.pointOnAbsolute(s*(Math.random()*(O-E)+E))),u.points[0]=f.p1.copy(),u.points[1]=f.p2.copy(),u.points[2]=x.p2.copy(),u.points[3]=b.p2.copy(),u.points[4]=_.p2.copy(),u.points[5]=P.p2.copy(),u.points[6]=z.p2.copy(),u.points[7]=k.p2.copy(),u.points[8]=w.p2.copy(),u.points[9]=w.p1.copy(),this.pieces[n+1][h].ts=u),h<e-1&&(u=this.pieces[n][h].rs,f=new m(u.points[0],u.points[1]),w=new m(u.points[2],u.points[1]),I=f.sin(w)>0,f=new m(f.p1,f.pointOnRelative(Math.random()*(A-T)+T)),x=f.perpendicularEnd(!I),x=new m(x.p1,x.pointOnAbsolute(i*(Math.random()*(B-q)+q))),w=new m(w.p1,w.pointOnRelative(Math.random()*(A-T)+T)),k=w.perpendicularEnd(I),k=new m(k.p1,k.pointOnAbsolute(i*(Math.random()*(B-q)+q))),M=new m(x.p2,k.p2),b=new m(M.p1,M.pointOnAbsolute(-s*(Math.random()*(C-R)+R))),M=new m(M.p2,M.p1),z=new m(M.p1,M.pointOnAbsolute(-s*(Math.random()*(C-R)+R))),_=b.perpendicularEnd(I),_=new m(_.p1,_.pointOnAbsolute(i*(Math.random()*(O-E)+E))),P=z.perpendicularEnd(!I),P=new m(P.p1,P.pointOnAbsolute(i*(Math.random()*(O-E)+E))),u.points[0]=f.p1.copy(),u.points[1]=f.p2.copy(),u.points[2]=x.p2.copy(),u.points[3]=b.p2.copy(),u.points[4]=_.p2.copy(),u.points[5]=P.p2.copy(),u.points[6]=z.p2.copy(),u.points[7]=k.p2.copy(),u.points[8]=w.p2.copy(),u.points[9]=w.p1.copy(),this.pieces[n][h+1].ls=u);this.associateImage()},v.prototype.associateImage=function(){let e,t,i,s,h,n,o,a,l,r;for(o=this.image.width,n=this.image.height,o/n>this.width/this.height?(h=this.height/n,l=0,a=(o-this.width/h)/2):(h=this.width/o,a=0,l=(n-this.height/h)/2),this.mech={scale:h,offsx:a,offsy:l},this.polyPieces=[],t=0;t<this.ny;t++)for(e=0;e<this.nx;e++)this.pieces[t][e].createDivPiece(this,h,a,l),this.polyPieces.push(new f(this.pieces[t][e],this));for(c(this.polyPieces),this.evaluateZIndex(),s=0;s<this.polyPieces.length;s++)for(i=0;i<this.polyPieces[s].pieces.length;i++)switch(r=this.polyPieces[s].pieces[i],this.divBoard.appendChild(r.theDiv),this.freeSpace){case 0:r.pTarget=new y(1*(this.reqWidth-(2.25+Math.random()/4)*this.dx)/p,Math.random()*(this.height-this.dy)-this.dy);break;case 1:r.pTarget=new y(1*(Math.random()*(this.width-this.dx)-this.dx)/p,this.reqHeight-(2.25+Math.random()/4)*this.dy)}window.setTimeout(function(e){return function(){e.launchAnimation()}}(this),1e3)},v.prototype.addRemovableEventListener=function(e,t){this.divBoard.addEventListener(e,t),this.listeners.push({event:e,funct:t})},v.prototype.remove1Listener=function(){if(0==this.listeners.length)return;let e=this.listeners.pop();this.divBoard.removeEventListener(e.event,e.funct)},v.prototype.removeAllListeners=function(){let e;while(this.listeners.length>0)e=this.listeners.pop(),this.divBoard.removeEventListener(e.event,e.funct)},v.prototype.launchAnimation=function(){this.anim={cpt:n?200:100},this.anim.tmr=window.setInterval(function(e){return function(){e.animate()}}(this),20)},v.prototype.animate=function(){let e,t,i,s,h;if(0==this.anim.cpt)return window.clearInterval(this.anim.tmr),delete this.anim,this.evaluateZIndex(),void this.beginGame();for(this.anim.cpt--,e=0;e<this.polyPieces.length;e++)for(t=0;t<this.polyPieces[e].pieces.length;t++)i=this.polyPieces[e].pieces[t],s=i.where(),h=i.pTarget,i.moveTo(new y((this.anim.cpt*s.x+h.x)/(this.anim.cpt+1),(this.anim.cpt*s.y+h.y)/(this.anim.cpt+1))),0==this.anim.cpt&&delete i.pTarget},v.prototype.animateEnd=function(){let e,t;if(O.log("over"),0==this.anim.cpt)return window.clearInterval(this.anim.tmr),void delete this.anim;this.anim.cpt--,e=parseFloat(this.canvMobile.style.left),t=parseFloat(this.canvMobile.style.top),this.canvMobile.style.left=(this.anim.cpt*e+this.anim.xfin)/(this.anim.cpt+1)+"px",this.canvMobile.style.top=(this.anim.cpt*t+this.anim.yfin)/(this.anim.cpt+1)+"px"},v.prototype.merge=function(e,t){let i,s,h;for(this.polyPieces[e].merge(this.polyPieces[t]),i=this.polyPieces[e],e>t?(this.polyPieces.splice(e,1),this.polyPieces.splice(t,1)):(this.polyPieces.splice(t,1),this.polyPieces.splice(e,1)),s=i.pieces.length,h=0;h<this.polyPieces.length&&this.polyPieces[h].pieces.length>=s;h++);return this.polyPieces.splice(h,0,i),h},v.prototype.evaluateZIndex=function(){let e,t,i;for(i=1,e=0;e<this.polyPieces.length;e++)for(t=0;t<this.polyPieces[e].pieces.length;t++)this.polyPieces[e].pieces[t].theDiv.style.zIndex=i++},v.prototype.beginGame=function(){let e=this;function t(){o<=0&&(e.removeAllListeners(),e.endGame())}function i(){l.is_game_stop&&(e.removeAllListeners(),e.endGame())}O.log("begin"),d(),h=setInterval(i,1e3),s=setInterval(t,1e3);let n=getComputedStyle(this.divGame);this.mouseOffsX=this.divGame.offsetLeft+parseFloat(n.borderLeftWidth),this.mouseOffsY=this.divGame.offsetTop+parseFloat(n.borderTopWidth),this.pieceMove=!1,this.addRemovableEventListener("mousedown",function(e){return function(t){e.mouseDownGame(t)}}(this)),this.addRemovableEventListener("touchstart",function(e){return function(t){e.touchDownGame(t)}}(this)),this.addRemovableEventListener("mouseup",function(e){return function(t){e.mouseUpGame(t)}}(this)),this.addRemovableEventListener("touchend",function(e){return function(t){e.mouseUpGame(t)}}(this)),this.addRemovableEventListener("mousemove",function(e){return function(t){e.mouseMoveGame(t)}}(this)),this.addRemovableEventListener("touchmove",function(e){return function(t){e.touchMoveGame(t)}}(this))},v.prototype.endGame=function(){O.log("endgame"),document.getElementById("forPuzzle").innerHTML="",o=0,clearInterval(s),clearInterval(h),l.looseGame()},v.prototype.mouseDownGame=function(e){O.log("mouse down"),this.pieceMove=this.lookForPiece(e,!1),!1!==this.pieceMove&&(this.emphasize(this.pieceMove.pp),this.pieceMove.offsx=e.pageX-this.mouseOffsX-parseFloat(this.canvMobile.style.left),this.pieceMove.offsy=e.pageY-this.mouseOffsY-parseFloat(this.canvMobile.style.top),this.divGame.style.cursor="move")},v.prototype.touchDownGame=function(e){let t=!!e.changedTouches&&e.changedTouches[0],i=t.pageX,s=t.pageY;O.log("touchDownGame",t),this.pieceMove=this.lookForPiece(e,!0),O.log(this.pieceMove),!1!==this.pieceMove&&(this.emphasize(this.pieceMove.pp),O.log(this.canvMobile),this.pieceMove.offsx=i-parseFloat(this.canvMobile.style.left),this.pieceMove.offsy=s-parseFloat(this.canvMobile.style.top),this.divGame.style.cursor="move")},v.prototype.mouseUpGame=function(e){let t,i,n;if(this.divGame.style.cursor="default",!1===this.pieceMove)return;O.log(this.pieceMove);let a=parseFloat(this.canvMobile.style.left),p=parseFloat(this.canvMobile.style.top);for(this.canvMobile.getContext("2d").clearRect(0,0,this.canvMobile.width,this.canvMobile.height),i=this.polyPieces[this.pieceMove.pp],t=0;t<i.pieces.length;t++)n=i.pieces[t],n.moveTo(new y(this.dx*(n.kx-1)+a,this.dy*(n.ky-1)+p)),n.theDiv.style.visibility="visible";let r=this.pieceMove.pp,c=!1,d=!1;do{for(c=!1,i=this.polyPieces[r],t=0;t<this.polyPieces.length;t++)if(t!==r&&i.ifNear(this.polyPieces[t])){r=this.merge(t,r),c=!0,d=!0;break}}while(c);if(!d){let e=this.polyPieces[r];for(this.polyPieces.splice(r,1),t=r;t<this.polyPieces.length&&this.polyPieces[t].pieces.length>=e.pieces.length;t++);this.polyPieces.splice(t,0,e)}if(this.evaluateZIndex(),this.pieceMove=!1,this.polyPieces.length>1)return;this.removeAllListeners(),O.log("COMPLETE"),o=0,document.getElementById("forPuzzle").innerHTML="",clearInterval(s),clearInterval(h),l.winGame();let m=this.canvMobile.getContext("2d");for(m.drawImage(this.image,this.mech.offsx,this.mech.offsy,this.width/this.mech.scale,this.height/this.mech.scale,0,0,this.width,this.height),this.anim={cpt:100,xorg:0,yorg:0,xfin:(this.reqWidth-this.dx*this.nx)/2,yfin:(this.reqHeight-this.dy*this.ny)/2},this.anim.xorg=parseFloat(this.polyPieces[0].pieces[0].theDiv.style.left)+this.dx,this.anim.yorg=parseFloat(this.polyPieces[0].pieces[0].theDiv.style.top)+this.dy,this.canvMobile.style.left=this.anim.xorg+"px",this.canvMobile.style.top=this.anim.yorg+"px",t=0;t<this.polyPieces[0].pieces.length;t++)this.polyPieces[0].pieces[t].theDiv.style.visibility="hidden";let u=Math.sqrt((this.anim.xorg-this.anim.xfin)*(this.anim.xorg-this.anim.xfin)+(this.anim.yorg-this.anim.yfin)*(this.anim.yorg-this.anim.yfin));this.anim.cpt=u/2,this.anim.cpt<12&&(this.anim.cpt=12),this.anim.cpt>100&&(this.anim.cpt=100),this.anim.cpt=Math.floor(this.anim.cpt),this.anim.tmr=window.setInterval(function(e){return function(){e.animateEnd()}}(this),20)},v.prototype.stopGame=function(){this.removeAllListeners(),this.anim.tmr=window.setInterval(function(e){return function(){e.animateEnd()}}(this),20)},v.prototype.mouseMoveGame=function(e){if(!1===this.pieceMove)return;if(0==(1&e.buttons))return void this.mouseUpGame(e);let t=e.pageX-this.mouseOffsX,i=e.pageY-this.mouseOffsY;t<2&&(t=2),t>Math.floor(parseFloat(this.divBoard.style.width))-2&&(t=Math.floor(parseFloat(this.divBoard.style.width))-2),i<2&&(i=2),i>Math.floor(parseFloat(this.divBoard.style.height))-2&&(i=Math.floor(parseFloat(this.divBoard.style.height))-2),this.canvMobile.style.left=t-this.pieceMove.offsx+"px",this.canvMobile.style.top=i-this.pieceMove.offsy+"px"},v.prototype.touchMoveGame=function(e){if(O.log("touchMoveGame"),!1===this.pieceMove)return;var t=e.changedTouches[0];let i=t.pageX-this.mouseOffsX,s=t.pageY-this.mouseOffsY;i<2&&(i=2),i>Math.floor(parseFloat(this.divBoard.style.width))-2&&(i=Math.floor(parseFloat(this.divBoard.style.width))-2),s<64&&(s=64),O.log(Math.floor(parseFloat(this.divBoard.style.height))-2),O.log("y",s),s>Math.floor(parseFloat(this.divBoard.style.height))-2&&(s=Math.floor(parseFloat(this.divBoard.style.height))-2),this.canvMobile.style.left=i-this.pieceMove.offsx+"px",this.canvMobile.style.top=s-this.pieceMove.offsy+"px"},v.prototype.lookForPiece=function(e,t){let i,s,h,n;if(t){O.log("touch event");let t=!!e.changedTouches&&e.changedTouches[0];i=t.clientX,s=t.clientY-120}else O.log("mouse event"),i=e.pageX,s=e.pageY-120;let o=i-this.mouseOffsX,a=s-this.mouseOffsY;for(h=this.polyPieces.length-1;h>=0;h--)for(n=this.polyPieces[h].pieces.length-1;n>=0;n--)if(this.polyPieces[h].pieces[n].insidePiece(o,a))return{pp:h,pc:n};return!1},v.prototype.emphasize=function(e){let t,i,s,h,n=this.polyPieces[e],o=this.canvMobile.getContext("2d"),a=w(n.pieces);for(o.save(),o.clearRect(0,0,this.canvMobile.width,this.canvMobile.height),o.beginPath(),t=0;t<a.length;t++)for(i=0;i<a[t].length;i++)switch(h=a[t][i],h.edge){case 0:n.pieces[h.kp].ts.drawPath(o,0,0,!1,0!=i);break;case 1:n.pieces[h.kp].rs.drawPath(o,0,0,!1,0!=i);break;case 2:n.pieces[h.kp].bs.drawPath(o,0,0,!0,0!=i);break;case 3:n.pieces[h.kp].ls.drawPath(o,0,0,!0,0!=i);break}for(o.fillStyle="none",o.shadowColor="rgba(0, 0, 0, 0.5)",o.shadowBlur=4,o.shadowOffsetX=4,o.shadowOffsetY=4,o.fill(),o.clip("evenodd"),o.drawImage(this.image,this.mech.offsx,this.mech.offsy,this.width/this.mech.scale,this.height/this.mech.scale,0,0,this.width,this.height),s=0;s<n.pieces.length;s++)n.pieces[s].theDiv.style.visibility="hidden";o.restore(),this.canvMobile.style.left=n.pieces[0].where().x-(n.pieces[0].kx-1)*this.dx+"px",this.canvMobile.style.top=n.pieces[0].where().y-(n.pieces[0].ky-1)*this.dy+"px",this.canvMobile.style.visibility="visible"},v.prototype.near=function(e,t,i,s){let h=e.where(),n=t.where();return!(Math.abs(h.x-n.x+i*this.dx)>this.dCoupling)&&!(Math.abs(h.y-n.y+s*this.dy)>this.dCoupling)},v.prototype.computenxAndny=function(){let e,t,i,s,h,n=this.image.width,o=this.image.height,a=this.npieces,p=1e9,l=Math.round(Math.sqrt(a*n/o)),r=Math.round(a/l);for(t=0;t<5;t++)for(s=r+t-2,e=0;e<5;e++)h=l+e-2,i=h*o/s/n,i=i+1/i-2,i+=Math.abs(1-h*s/a),i<p&&(p=i,this.nx=h,this.ny=s)};new v({img:e,width:document.getElementById("puzzle_wrapper").clientWidth,height:document.getElementById("puzzle_wrapper").clientHeight,idiv:"forPuzzle"})}}};var W=i(11639),S=i(60854),$=i(44458),H=i(63190),Y=i(69984),U=i.n(Y);const X=(0,W.Z)(N,[["render",q]]),j=X;U()(N,"components",{QInnerLoading:S.Z,QCard:$.Z,QCardSection:H.Z})}}]);